{"version":3,"sources":["file:///Users/mike/Documents/self/game-2d-demo/assets/scripts/components/CameraFollow.js"],"names":["_cjsLoader","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","cc","Class","extends","Component","properties","target","default","type","Node","camera","Camera","followSpeed","Float","offsetX","offsetY","smoothFollow","Boolean","followX","followY","onLoad","initializeCamera","start","node","initialPosition","position","clone","update","deltaTime","followTarget","getComponent","console","error","log","targetPosition","currentPosition","targetX","x","targetY","y","newPosition","lerpFactor","v3","lerp","z","setTarget","setOffset","setFollowSpeed","speed","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n cc.Class({\n     extends: cc.Component,\n\n     properties: {\n         target: {\n             default: null,\n             type: cc.Node\n         },\n         camera: {\n             default: null,\n             type: cc.Camera\n         },\n         followSpeed: {\n             default: 5,\n             type: cc.Float\n         },\n         offsetX: {\n             default: 0,\n             type: cc.Float\n         },\n         offsetY: {\n             default: 0,\n             type: cc.Float\n         },\n         smoothFollow: {\n             default: true,\n             type: cc.Boolean\n         },\n         followX: {\n             default: true,\n             type: cc.Boolean\n         },\n         followY: {\n             default: true,\n             type: cc.Boolean\n         }\n     },\n\n     onLoad() {\n         this.initializeCamera();\n     },\n\n     start() {\n         if (this.camera && this.camera.node) {\n             this.initialPosition = this.camera.node.position.clone();\n         }\n     },\n\n     update(deltaTime) {\n         if (this.target && this.camera) {\n             this.followTarget(deltaTime);\n         }\n     },\n\n     /**\n      * 初始化相機\n      */\n     initializeCamera() {\n         if (!this.camera) {\n             this.camera = this.getComponent(cc.Camera);\n         }\n\n         if (!this.camera) {\n             console.error('CameraFollow: 找不到相機組件');\n             return;\n         }\n\n         console.log('相機跟隨系統初始化完成');\n     },\n\n     /**\n      * 跟隨目標\n      */\n     followTarget(deltaTime) {\n         const targetPosition = this.target.position.clone();\n         const currentPosition = this.camera.node.position.clone();\n\n         // 計算目標位置\n         let targetX = currentPosition.x;\n         let targetY = currentPosition.y;\n\n         if (this.followX) {\n             targetX = targetPosition.x + this.offsetX;\n         }\n\n         if (this.followY) {\n             targetY = targetPosition.y + this.offsetY;\n         }\n\n         // 計算新位置\n         let newPosition;\n\n         if (this.smoothFollow) {\n             // 平滑跟隨\n             const lerpFactor = this.followSpeed * deltaTime;\n             newPosition = cc.v3(\n                 cc.lerp(currentPosition.x, targetX, lerpFactor),\n                 cc.lerp(currentPosition.y, targetY, lerpFactor),\n                 currentPosition.z\n             );\n         } else {\n             // 直接跟隨\n             newPosition = cc.v3(targetX, targetY, currentPosition.z);\n         }\n\n         // 更新相機位置\n         this.camera.node.position = newPosition;\n     },\n\n     /**\n      * 設定跟隨目標\n      */\n     setTarget(target) {\n         this.target = target;\n         console.log('相機跟隨目標已設定');\n     },\n\n     /**\n      * 設定跟隨偏移\n      */\n     setOffset(x, y) {\n         this.offsetX = x;\n         this.offsetY = y;\n     },\n\n     /**\n      * 設定跟隨速度\n      */\n     setFollowSpeed(speed) {\n         this.followSpeed = speed;\n     }\n });\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, {});\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}