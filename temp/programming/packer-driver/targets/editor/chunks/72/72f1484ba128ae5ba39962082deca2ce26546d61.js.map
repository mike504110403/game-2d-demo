{"version":3,"sources":["file:///Users/mike/Documents/self/game-2d-demo/assets/scripts/components/PlayerController.ts"],"names":["ccclass","property","cc","_decorator","PlayerController","RigidBody2D","Sprite","Component","isGrounded","isMoving","facingRight","onLoad","initializePlayer","start","setupInput","update","deltaTime","handleInput","updatePlayerState","console","log","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","event","keyCode","macro","KEY","left","a","moveLeft","right","d","moveRight","space","up","w","jump","stopMoving","rigidBody","linearVelocity","v2","speed","y","x","jumpForce","velocity","updateSprite","sprite","node","scaleX"],"mappings":"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","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n/**\n * 玩家控制器\n * 負責處理玩家角色的移動、跳躍、攻擊等行為\n */\n@ccclass('PlayerController')\nexport class PlayerController extends cc.Component {\n    @property(cc.RigidBody2D)\n    rigidBody: cc.RigidBody2D = null;\n\n    @property(cc.Sprite)\n    sprite: cc.Sprite = null;\n\n    @property\n    speed: number = 200;\n\n    @property\n    jumpForce: number = 500;\n\n    // 玩家狀態\n    private isGrounded: boolean = false;\n    private isMoving: boolean = false;\n    private facingRight: boolean = true;\n\n    onLoad() {\n        this.initializePlayer();\n    }\n\n    start() {\n        this.setupInput();\n    }\n\n    update(deltaTime: number) {\n        this.handleInput();\n        this.updatePlayerState();\n    }\n\n    /**\n     * 初始化玩家\n     */\n    private initializePlayer(): void {\n        console.log('玩家控制器初始化完成');\n    }\n\n    /**\n     * 設定輸入系統\n     */\n    private setupInput(): void {\n        // 註冊鍵盤事件\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    }\n\n    /**\n     * 鍵盤按下事件\n     */\n    private onKeyDown(event: cc.Event.EventKeyboard): void {\n        switch(event.keyCode) {\n            case cc.macro.KEY.left:\n            case cc.macro.KEY.a:\n                this.moveLeft();\n                break;\n            case cc.macro.KEY.right:\n            case cc.macro.KEY.d:\n                this.moveRight();\n                break;\n            case cc.macro.KEY.space:\n            case cc.macro.KEY.up:\n            case cc.macro.KEY.w:\n                this.jump();\n                break;\n        }\n    }\n\n    /**\n     * 鍵盤釋放事件\n     */\n    private onKeyUp(event: cc.Event.EventKeyboard): void {\n        switch(event.keyCode) {\n            case cc.macro.KEY.left:\n            case cc.macro.KEY.a:\n            case cc.macro.KEY.right:\n            case cc.macro.KEY.d:\n                this.stopMoving();\n                break;\n        }\n    }\n\n    /**\n     * 處理輸入\n     */\n    private handleInput(): void {\n        // 輸入處理邏輯\n    }\n\n    /**\n     * 向左移動\n     */\n    private moveLeft(): void {\n        if (this.rigidBody) {\n            this.rigidBody.linearVelocity = cc.v2(-this.speed, this.rigidBody.linearVelocity.y);\n            this.facingRight = false;\n            this.isMoving = true;\n        }\n    }\n\n    /**\n     * 向右移動\n     */\n    private moveRight(): void {\n        if (this.rigidBody) {\n            this.rigidBody.linearVelocity = cc.v2(this.speed, this.rigidBody.linearVelocity.y);\n            this.facingRight = true;\n            this.isMoving = true;\n        }\n    }\n\n    /**\n     * 停止移動\n     */\n    private stopMoving(): void {\n        if (this.rigidBody) {\n            this.rigidBody.linearVelocity = cc.v2(0, this.rigidBody.linearVelocity.y);\n            this.isMoving = false;\n        }\n    }\n\n    /**\n     * 跳躍\n     */\n    private jump(): void {\n        if (this.isGrounded && this.rigidBody) {\n            this.rigidBody.linearVelocity = cc.v2(this.rigidBody.linearVelocity.x, this.jumpForce);\n            this.isGrounded = false;\n        }\n    }\n\n    /**\n     * 更新玩家狀態\n     */\n    private updatePlayerState(): void {\n        if (this.rigidBody) {\n            const velocity = this.rigidBody.linearVelocity;\n            \n            // 檢查是否在地面上\n            if (velocity.y === 0) {\n                this.isGrounded = true;\n            } else if (velocity.y < -50) {\n                this.isGrounded = false;\n            }\n\n            // 更新精靈圖片\n            this.updateSprite();\n        }\n    }\n\n    /**\n     * 更新精靈圖片\n     */\n    private updateSprite(): void {\n        if (this.sprite && this.sprite.node) {\n            // 根據面向方向翻轉圖片\n            this.sprite.node.scaleX = this.facingRight ? 1 : -1;\n        }\n    }\n}"]}