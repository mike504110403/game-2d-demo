{"version":3,"sources":["file:///Users/mike/Documents/self/game-2d-demo/assets/scripts/scenes/MapleStoryScene.ts"],"names":["ccclass","property","cc","_decorator","MapleStoryScene","Node","Prefab","Component","sceneWidth","sceneHeight","isInitialized","onLoad","initializeScene","start","setupScene","console","log","createContainers","createBackgroundSystem","createPlatformSystem","createPlayer","setupCamera","backgroundContainer","node","addChild","platformContainer","playerContainer","uiContainer","createSkyLayer","createMountainLayer","createTreeLayer","createCloudLayer","parallaxComponent","addComponent","skyLayer","Sprite","getComponent","spriteFrame","createSkySpriteFrame","setScale","setPosition","mountainLayer","createMountainSpriteFrame","treeLayer","i","tree","createTreeSpriteFrame","x","y","Math","sin","random","cloudLayer","cloud","createCloudSpriteFrame","platformGenerator","createInitialGround","ground","createGroundSpriteFrame","collider","BoxCollider","size","rigidBody","RigidBody2D","type","Type","Static","player","createPlayerSpriteFrame","Dynamic","gravityScale","playerController","camera","Camera","main","projection","ProjectionType","ORTHO","orthoHeight","cameraFollow","texture","Texture2D","canvas","document","createElement","width","height","ctx","getContext","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","initWithElement","SpriteFrame","setTexture","beginPath","moveTo","lineTo","closePath","fill","arc","PI"],"mappings":";;;;;;;;;;;;;;;;;;;;OAAM;AAAEA,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBC,EAAE,CAACC,U;AAEjC;AACA;AACA;AACA;;iCAEaC,e,WADZJ,OAAO,CAAC,iBAAD,C,UAEHC,QAAQ,CAACC,EAAE,CAACG,IAAJ,C,UAGRJ,QAAQ,CAACC,EAAE,CAACG,IAAJ,C,UAGRJ,QAAQ,CAACC,EAAE,CAACG,IAAJ,C,UAGRJ,QAAQ,CAACC,EAAE,CAACG,IAAJ,C,UAGRJ,QAAQ,CAACC,EAAE,CAACI,MAAJ,C,2BAdb,MACaF,eADb,SACqCF,EAAE,CAACK,SADxC,CACkD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAgB9C;AAhB8C,eAiBtCC,UAjBsC,GAiBjB,IAjBiB;AAAA,eAkBtCC,WAlBsC,GAkBhB,GAlBgB;AAAA,eAmBtCC,aAnBsC,GAmBb,KAnBa;AAAA;;AAqB9CC,QAAAA,MAAM,GAAG;AACL,eAAKC,eAAL;AACH;;AAEDC,QAAAA,KAAK,GAAG;AACJ,eAAKC,UAAL;AACH;AAED;AACJ;AACA;;;AACYF,QAAAA,eAAe,GAAS;AAC5B,cAAI,KAAKF,aAAT,EAAwB;AAExBK,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAH4B,CAK5B;;AACA,eAAKC,gBAAL,GAN4B,CAQ5B;;AACA,eAAKC,sBAAL,GAT4B,CAW5B;;AACA,eAAKC,oBAAL,GAZ4B,CAc5B;;AACA,eAAKC,YAAL,GAf4B,CAiB5B;;AACA,eAAKC,WAAL;AAEA,eAAKX,aAAL,GAAqB,IAArB;AACAK,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACH;AAED;AACJ;AACA;;;AACYC,QAAAA,gBAAgB,GAAS;AAC7B;AACA,cAAI,CAAC,KAAKK,mBAAV,EAA+B;AAC3B,iBAAKA,mBAAL,GAA2B,IAAIpB,EAAE,CAACG,IAAP,CAAY,qBAAZ,CAA3B;AACA,iBAAKkB,IAAL,CAAUC,QAAV,CAAmB,KAAKF,mBAAxB;AACH,WAL4B,CAO7B;;;AACA,cAAI,CAAC,KAAKG,iBAAV,EAA6B;AACzB,iBAAKA,iBAAL,GAAyB,IAAIvB,EAAE,CAACG,IAAP,CAAY,mBAAZ,CAAzB;AACA,iBAAKkB,IAAL,CAAUC,QAAV,CAAmB,KAAKC,iBAAxB;AACH,WAX4B,CAa7B;;;AACA,cAAI,CAAC,KAAKC,eAAV,EAA2B;AACvB,iBAAKA,eAAL,GAAuB,IAAIxB,EAAE,CAACG,IAAP,CAAY,iBAAZ,CAAvB;AACA,iBAAKkB,IAAL,CAAUC,QAAV,CAAmB,KAAKE,eAAxB;AACH,WAjB4B,CAmB7B;;;AACA,cAAI,CAAC,KAAKC,WAAV,EAAuB;AACnB,iBAAKA,WAAL,GAAmB,IAAIzB,EAAE,CAACG,IAAP,CAAY,aAAZ,CAAnB;AACA,iBAAKkB,IAAL,CAAUC,QAAV,CAAmB,KAAKG,WAAxB;AACH;AACJ;AAED;AACJ;AACA;;;AACYT,QAAAA,sBAAsB,GAAS;AACnC;AACA,eAAKU,cAAL;AACA,eAAKC,mBAAL;AACA,eAAKC,eAAL;AACA,eAAKC,gBAAL,GALmC,CAOnC;;AACA,gBAAMC,iBAAiB,GAAG,KAAKV,mBAAL,CAAyBW,YAAzB,CAAsC/B,EAAE,CAACK,SAAzC,CAA1B,CARmC,CASnC;AACH;AAED;AACJ;AACA;;;AACYqB,QAAAA,cAAc,GAAS;AAC3B,gBAAMM,QAAQ,GAAG,IAAIhC,EAAE,CAACG,IAAP,CAAY,UAAZ,CAAjB;AACA6B,UAAAA,QAAQ,CAACD,YAAT,CAAsB/B,EAAE,CAACiC,MAAzB;AACAD,UAAAA,QAAQ,CAACE,YAAT,CAAsBlC,EAAE,CAACiC,MAAzB,EAAiCE,WAAjC,GAA+C,KAAKC,oBAAL,EAA/C;AACAJ,UAAAA,QAAQ,CAACK,QAAT,CAAkB,CAAlB,EAAqB,CAArB;AACAL,UAAAA,QAAQ,CAACM,WAAT,CAAqB,CAArB,EAAwB,GAAxB;AACA,eAAKlB,mBAAL,CAAyBE,QAAzB,CAAkCU,QAAlC;AACH;AAED;AACJ;AACA;;;AACYL,QAAAA,mBAAmB,GAAS;AAChC,gBAAMY,aAAa,GAAG,IAAIvC,EAAE,CAACG,IAAP,CAAY,eAAZ,CAAtB;AACAoC,UAAAA,aAAa,CAACR,YAAd,CAA2B/B,EAAE,CAACiC,MAA9B;AACAM,UAAAA,aAAa,CAACL,YAAd,CAA2BlC,EAAE,CAACiC,MAA9B,EAAsCE,WAAtC,GAAoD,KAAKK,yBAAL,EAApD;AACAD,UAAAA,aAAa,CAACD,WAAd,CAA0B,CAA1B,EAA6B,CAAC,GAA9B;AACAC,UAAAA,aAAa,CAACF,QAAd,CAAuB,CAAvB,EAA0B,CAA1B;AACA,eAAKjB,mBAAL,CAAyBE,QAAzB,CAAkCiB,aAAlC;AACH;AAED;AACJ;AACA;;;AACYX,QAAAA,eAAe,GAAS;AAC5B,gBAAMa,SAAS,GAAG,IAAIzC,EAAE,CAACG,IAAP,CAAY,WAAZ,CAAlB;AACA,eAAKiB,mBAAL,CAAyBE,QAAzB,CAAkCmB,SAAlC,EAF4B,CAI5B;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,kBAAMC,IAAI,GAAG,IAAI3C,EAAE,CAACG,IAAP,CAAa,QAAOuC,CAAE,EAAtB,CAAb;AACAC,YAAAA,IAAI,CAACZ,YAAL,CAAkB/B,EAAE,CAACiC,MAArB;AACAU,YAAAA,IAAI,CAACT,YAAL,CAAkBlC,EAAE,CAACiC,MAArB,EAA6BE,WAA7B,GAA2C,KAAKS,qBAAL,EAA3C;AAEA,kBAAMC,CAAC,GAAG,CAACH,CAAC,GAAG,CAAL,IAAU,GAApB;AACA,kBAAMI,CAAC,GAAG,CAAC,GAAD,GAAOC,IAAI,CAACC,GAAL,CAASN,CAAT,IAAc,EAA/B;AACAC,YAAAA,IAAI,CAACL,WAAL,CAAiBO,CAAjB,EAAoBC,CAApB;AACAH,YAAAA,IAAI,CAACN,QAAL,CAAc,MAAMU,IAAI,CAACE,MAAL,KAAgB,GAApC;AAEAR,YAAAA,SAAS,CAACnB,QAAV,CAAmBqB,IAAnB;AACH;AACJ;AAED;AACJ;AACA;;;AACYd,QAAAA,gBAAgB,GAAS;AAC7B,gBAAMqB,UAAU,GAAG,IAAIlD,EAAE,CAACG,IAAP,CAAY,YAAZ,CAAnB;AACA,eAAKiB,mBAAL,CAAyBE,QAAzB,CAAkC4B,UAAlC,EAF6B,CAI7B;;AACA,eAAK,IAAIR,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,kBAAMS,KAAK,GAAG,IAAInD,EAAE,CAACG,IAAP,CAAa,SAAQuC,CAAE,EAAvB,CAAd;AACAS,YAAAA,KAAK,CAACpB,YAAN,CAAmB/B,EAAE,CAACiC,MAAtB;AACAkB,YAAAA,KAAK,CAACjB,YAAN,CAAmBlC,EAAE,CAACiC,MAAtB,EAA8BE,WAA9B,GAA4C,KAAKiB,sBAAL,EAA5C;AAEA,kBAAMP,CAAC,GAAG,CAACH,CAAC,GAAG,CAAL,IAAU,GAApB;AACA,kBAAMI,CAAC,GAAG,MAAMC,IAAI,CAACE,MAAL,KAAgB,GAAhC;AACAE,YAAAA,KAAK,CAACb,WAAN,CAAkBO,CAAlB,EAAqBC,CAArB;AACAK,YAAAA,KAAK,CAACd,QAAN,CAAe,MAAMU,IAAI,CAACE,MAAL,KAAgB,GAArC;AAEAC,YAAAA,UAAU,CAAC5B,QAAX,CAAoB6B,KAApB;AACH;AACJ;AAED;AACJ;AACA;;;AACYlC,QAAAA,oBAAoB,GAAS;AACjC;AACA,gBAAMoC,iBAAiB,GAAG,KAAK9B,iBAAL,CAAuBQ,YAAvB,CAAoC/B,EAAE,CAACK,SAAvC,CAA1B,CAFiC,CAGjC;AAEA;;AACA,eAAKiD,mBAAL;AACH;AAED;AACJ;AACA;;;AACYA,QAAAA,mBAAmB,GAAS;AAChC,gBAAMC,MAAM,GAAG,IAAIvD,EAAE,CAACG,IAAP,CAAY,QAAZ,CAAf;AACAoD,UAAAA,MAAM,CAACxB,YAAP,CAAoB/B,EAAE,CAACiC,MAAvB;AACAsB,UAAAA,MAAM,CAACrB,YAAP,CAAoBlC,EAAE,CAACiC,MAAvB,EAA+BE,WAA/B,GAA6C,KAAKqB,uBAAL,EAA7C;AACAD,UAAAA,MAAM,CAACjB,WAAP,CAAmB,CAAnB,EAAsB,CAAC,GAAvB;AACAiB,UAAAA,MAAM,CAAClB,QAAP,CAAgB,KAAK/B,UAAL,GAAkB,GAAlC,EAAuC,CAAvC,EALgC,CAOhC;;AACA,gBAAMmD,QAAQ,GAAGF,MAAM,CAACxB,YAAP,CAAoB/B,EAAE,CAAC0D,WAAvB,CAAjB;AACAD,UAAAA,QAAQ,CAACE,IAAT,GAAgB3D,EAAE,CAAC2D,IAAH,CAAQ,KAAKrD,UAAb,EAAyB,GAAzB,CAAhB;AAEA,gBAAMsD,SAAS,GAAGL,MAAM,CAACxB,YAAP,CAAoB/B,EAAE,CAAC6D,WAAvB,CAAlB;AACAD,UAAAA,SAAS,CAACE,IAAV,GAAiB9D,EAAE,CAAC6D,WAAH,CAAeE,IAAf,CAAoBC,MAArC;AAEA,eAAKzC,iBAAL,CAAuBD,QAAvB,CAAgCiC,MAAhC;AACH;AAED;AACJ;AACA;;;AACYrC,QAAAA,YAAY,GAAS;AACzB,gBAAM+C,MAAM,GAAG,IAAIjE,EAAE,CAACG,IAAP,CAAY,QAAZ,CAAf;AACA8D,UAAAA,MAAM,CAAClC,YAAP,CAAoB/B,EAAE,CAACiC,MAAvB;AACAgC,UAAAA,MAAM,CAAC/B,YAAP,CAAoBlC,EAAE,CAACiC,MAAvB,EAA+BE,WAA/B,GAA6C,KAAK+B,uBAAL,EAA7C;AACAD,UAAAA,MAAM,CAAC3B,WAAP,CAAmB,CAAnB,EAAsB,CAAtB,EAJyB,CAMzB;;AACA,gBAAMsB,SAAS,GAAGK,MAAM,CAAClC,YAAP,CAAoB/B,EAAE,CAAC6D,WAAvB,CAAlB;AACAD,UAAAA,SAAS,CAACE,IAAV,GAAiB9D,EAAE,CAAC6D,WAAH,CAAeE,IAAf,CAAoBI,OAArC;AACAP,UAAAA,SAAS,CAACQ,YAAV,GAAyB,CAAzB;AAEA,gBAAMX,QAAQ,GAAGQ,MAAM,CAAClC,YAAP,CAAoB/B,EAAE,CAAC0D,WAAvB,CAAjB;AACAD,UAAAA,QAAQ,CAACE,IAAT,GAAgB3D,EAAE,CAAC2D,IAAH,CAAQ,EAAR,EAAY,EAAZ,CAAhB,CAZyB,CAczB;;AACA,gBAAMU,gBAAgB,GAAGJ,MAAM,CAAClC,YAAP,CAAoB/B,EAAE,CAACK,SAAvB,CAAzB,CAfyB,CAgBzB;;AAEA,eAAKmB,eAAL,CAAqBF,QAArB,CAA8B2C,MAA9B;AACH;AAED;AACJ;AACA;;;AACY9C,QAAAA,WAAW,GAAS;AACxB,gBAAMmD,MAAM,GAAGtE,EAAE,CAACuE,MAAH,CAAUC,IAAzB;;AACA,cAAIF,MAAJ,EAAY;AACR;AACAA,YAAAA,MAAM,CAACG,UAAP,GAAoBzE,EAAE,CAACuE,MAAH,CAAUG,cAAV,CAAyBC,KAA7C;AACAL,YAAAA,MAAM,CAACM,WAAP,GAAqB,GAArB,CAHQ,CAKR;;AACA,kBAAMC,YAAY,GAAGP,MAAM,CAACjD,IAAP,CAAYU,YAAZ,CAAyB/B,EAAE,CAACK,SAA5B,CAArB,CANQ,CAOR;AACH;AACJ;AAED;AACJ;AACA;;;AACYO,QAAAA,UAAU,GAAS;AACvBC,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACH,SArP6C,CAuP9C;;;AACQsB,QAAAA,oBAAoB,GAAmB;AAC3C,gBAAM0C,OAAO,GAAG,IAAI9E,EAAE,CAAC+E,SAAP,EAAhB;AACA,gBAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,UAAAA,MAAM,CAACG,KAAP,GAAe,GAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgB,GAAhB;AACA,gBAAMC,GAAG,GAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAZ;AAEA,gBAAMC,QAAQ,GAAGF,GAAG,CAACG,oBAAJ,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,GAAlC,CAAjB;AACAD,UAAAA,QAAQ,CAACE,YAAT,CAAsB,CAAtB,EAAyB,SAAzB;AACAF,UAAAA,QAAQ,CAACE,YAAT,CAAsB,GAAtB,EAA2B,SAA3B;AACAF,UAAAA,QAAQ,CAACE,YAAT,CAAsB,CAAtB,EAAyB,SAAzB;AAEAJ,UAAAA,GAAG,CAACK,SAAJ,GAAgBH,QAAhB;AACAF,UAAAA,GAAG,CAACM,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,GAAnB,EAAwB,GAAxB;AAEAb,UAAAA,OAAO,CAACc,eAAR,CAAwBZ,MAAxB;AACA,gBAAM7C,WAAW,GAAG,IAAInC,EAAE,CAAC6F,WAAP,EAApB;AACA1D,UAAAA,WAAW,CAAC2D,UAAZ,CAAuBhB,OAAvB;AACA,iBAAO3C,WAAP;AACH;;AAEOK,QAAAA,yBAAyB,GAAmB;AAChD,gBAAMsC,OAAO,GAAG,IAAI9E,EAAE,CAAC+E,SAAP,EAAhB;AACA,gBAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,UAAAA,MAAM,CAACG,KAAP,GAAe,GAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgB,GAAhB;AACA,gBAAMC,GAAG,GAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAZ,CALgD,CAOhD;;AACAD,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACU,SAAJ;AACAV,UAAAA,GAAG,CAACW,MAAJ,CAAW,CAAX,EAAc,GAAd;AACAX,UAAAA,GAAG,CAACY,MAAJ,CAAW,EAAX,EAAe,GAAf;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,GAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,GAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,EAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,EAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,EAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,EAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,GAAhB;AACAZ,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgB,GAAhB;AACAZ,UAAAA,GAAG,CAACa,SAAJ;AACAb,UAAAA,GAAG,CAACc,IAAJ;AAEArB,UAAAA,OAAO,CAACc,eAAR,CAAwBZ,MAAxB;AACA,gBAAM7C,WAAW,GAAG,IAAInC,EAAE,CAAC6F,WAAP,EAApB;AACA1D,UAAAA,WAAW,CAAC2D,UAAZ,CAAuBhB,OAAvB;AACA,iBAAO3C,WAAP;AACH;;AAEOS,QAAAA,qBAAqB,GAAmB;AAC5C,gBAAMkC,OAAO,GAAG,IAAI9E,EAAE,CAAC+E,SAAP,EAAhB;AACA,gBAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,UAAAA,MAAM,CAACG,KAAP,GAAe,GAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgB,GAAhB;AACA,gBAAMC,GAAG,GAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAZ,CAL4C,CAO5C;;AACAD,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACM,QAAJ,CAAa,EAAb,EAAiB,GAAjB,EAAsB,EAAtB,EAA0B,GAA1B,EAT4C,CAW5C;;AACAN,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACU,SAAJ;AACAV,UAAAA,GAAG,CAACe,GAAJ,CAAQ,EAAR,EAAY,GAAZ,EAAiB,EAAjB,EAAqB,CAArB,EAAwBrD,IAAI,CAACsD,EAAL,GAAU,CAAlC;AACAhB,UAAAA,GAAG,CAACc,IAAJ;AAEArB,UAAAA,OAAO,CAACc,eAAR,CAAwBZ,MAAxB;AACA,gBAAM7C,WAAW,GAAG,IAAInC,EAAE,CAAC6F,WAAP,EAApB;AACA1D,UAAAA,WAAW,CAAC2D,UAAZ,CAAuBhB,OAAvB;AACA,iBAAO3C,WAAP;AACH;;AAEOiB,QAAAA,sBAAsB,GAAmB;AAC7C,gBAAM0B,OAAO,GAAG,IAAI9E,EAAE,CAAC+E,SAAP,EAAhB;AACA,gBAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,UAAAA,MAAM,CAACG,KAAP,GAAe,GAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgB,EAAhB;AACA,gBAAMC,GAAG,GAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAZ,CAL6C,CAO7C;;AACAD,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACU,SAAJ;AACAV,UAAAA,GAAG,CAACe,GAAJ,CAAQ,EAAR,EAAY,EAAZ,EAAgB,EAAhB,EAAoB,CAApB,EAAuBrD,IAAI,CAACsD,EAAL,GAAU,CAAjC;AACAhB,UAAAA,GAAG,CAACe,GAAJ,CAAQ,EAAR,EAAY,EAAZ,EAAgB,EAAhB,EAAoB,CAApB,EAAuBrD,IAAI,CAACsD,EAAL,GAAU,CAAjC;AACAhB,UAAAA,GAAG,CAACe,GAAJ,CAAQ,EAAR,EAAY,EAAZ,EAAgB,EAAhB,EAAoB,CAApB,EAAuBrD,IAAI,CAACsD,EAAL,GAAU,CAAjC;AACAhB,UAAAA,GAAG,CAACe,GAAJ,CAAQ,EAAR,EAAY,EAAZ,EAAgB,EAAhB,EAAoB,CAApB,EAAuBrD,IAAI,CAACsD,EAAL,GAAU,CAAjC;AACAhB,UAAAA,GAAG,CAACc,IAAJ;AAEArB,UAAAA,OAAO,CAACc,eAAR,CAAwBZ,MAAxB;AACA,gBAAM7C,WAAW,GAAG,IAAInC,EAAE,CAAC6F,WAAP,EAApB;AACA1D,UAAAA,WAAW,CAAC2D,UAAZ,CAAuBhB,OAAvB;AACA,iBAAO3C,WAAP;AACH;;AAEOqB,QAAAA,uBAAuB,GAAmB;AAC9C,gBAAMsB,OAAO,GAAG,IAAI9E,EAAE,CAAC+E,SAAP,EAAhB;AACA,gBAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,UAAAA,MAAM,CAACG,KAAP,GAAe,GAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgB,GAAhB;AACA,gBAAMC,GAAG,GAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAZ,CAL8C,CAO9C;;AACAD,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACM,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,GAAnB,EAAwB,GAAxB,EAT8C,CAW9C;;AACAN,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;;AACA,eAAK,IAAIhD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AACzB,kBAAMG,CAAC,GAAGE,IAAI,CAACE,MAAL,KAAgB,GAA1B;AACA,kBAAMH,CAAC,GAAGC,IAAI,CAACE,MAAL,KAAgB,GAA1B;AACAoC,YAAAA,GAAG,CAACM,QAAJ,CAAa9C,CAAb,EAAgBC,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB;AACH;;AAEDgC,UAAAA,OAAO,CAACc,eAAR,CAAwBZ,MAAxB;AACA,gBAAM7C,WAAW,GAAG,IAAInC,EAAE,CAAC6F,WAAP,EAApB;AACA1D,UAAAA,WAAW,CAAC2D,UAAZ,CAAuBhB,OAAvB;AACA,iBAAO3C,WAAP;AACH;;AAEO+B,QAAAA,uBAAuB,GAAmB;AAC9C,gBAAMY,OAAO,GAAG,IAAI9E,EAAE,CAAC+E,SAAP,EAAhB;AACA,gBAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,UAAAA,MAAM,CAACG,KAAP,GAAe,EAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgB,EAAhB;AACA,gBAAMC,GAAG,GAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAZ,CAL8C,CAO9C;AACA;;AACAD,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACU,SAAJ;AACAV,UAAAA,GAAG,CAACe,GAAJ,CAAQ,EAAR,EAAY,EAAZ,EAAgB,EAAhB,EAAoB,CAApB,EAAuBrD,IAAI,CAACsD,EAAL,GAAU,CAAjC;AACAhB,UAAAA,GAAG,CAACc,IAAJ,GAZ8C,CAc9C;;AACAd,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACM,QAAJ,CAAa,EAAb,EAAiB,EAAjB,EAAqB,EAArB,EAAyB,EAAzB,EAhB8C,CAkB9C;;AACAN,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACM,QAAJ,CAAa,EAAb,EAAiB,EAAjB,EAAqB,CAArB,EAAwB,EAAxB;AACAN,UAAAA,GAAG,CAACM,QAAJ,CAAa,EAAb,EAAiB,EAAjB,EAAqB,CAArB,EAAwB,EAAxB,EArB8C,CAuB9C;;AACAN,UAAAA,GAAG,CAACK,SAAJ,GAAgB,SAAhB;AACAL,UAAAA,GAAG,CAACM,QAAJ,CAAa,EAAb,EAAiB,EAAjB,EAAqB,CAArB,EAAwB,EAAxB;AACAN,UAAAA,GAAG,CAACM,QAAJ,CAAa,EAAb,EAAiB,EAAjB,EAAqB,CAArB,EAAwB,EAAxB;AAEAb,UAAAA,OAAO,CAACc,eAAR,CAAwBZ,MAAxB;AACA,gBAAM7C,WAAW,GAAG,IAAInC,EAAE,CAAC6F,WAAP,EAApB;AACA1D,UAAAA,WAAW,CAAC2D,UAAZ,CAAuBhB,OAAvB;AACA,iBAAO3C,WAAP;AACH;;AAhZ6C,O;;;;;iBAEf,I;;;;;;;iBAGF,I;;;;;;;iBAGF,I;;;;;;;iBAGJ,I;;;;;;;iBAGG,I","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n/**\n * 楓之谷風格場景設定\n * 完整的橫向捲軸遊戲場景管理\n */\n@ccclass('MapleStoryScene')\nexport class MapleStoryScene extends cc.Component {\n    @property(cc.Node)\n    backgroundContainer: cc.Node = null;\n\n    @property(cc.Node)\n    platformContainer: cc.Node = null;\n\n    @property(cc.Node)\n    playerContainer: cc.Node = null;\n\n    @property(cc.Node)\n    uiContainer: cc.Node = null;\n\n    @property(cc.Prefab)\n    playerPrefab: cc.Prefab = null;\n\n    // 場景設定\n    private sceneWidth: number = 3000;\n    private sceneHeight: number = 800;\n    private isInitialized: boolean = false;\n\n    onLoad() {\n        this.initializeScene();\n    }\n\n    start() {\n        this.setupScene();\n    }\n\n    /**\n     * 初始化場景\n     */\n    private initializeScene(): void {\n        if (this.isInitialized) return;\n        \n        console.log('楓之谷場景初始化開始');\n        \n        // 建立容器節點\n        this.createContainers();\n        \n        // 建立背景系統\n        this.createBackgroundSystem();\n        \n        // 建立平台系統\n        this.createPlatformSystem();\n        \n        // 建立玩家\n        this.createPlayer();\n        \n        // 設定相機\n        this.setupCamera();\n        \n        this.isInitialized = true;\n        console.log('楓之谷場景初始化完成');\n    }\n\n    /**\n     * 建立容器節點\n     */\n    private createContainers(): void {\n        // 背景容器\n        if (!this.backgroundContainer) {\n            this.backgroundContainer = new cc.Node('BackgroundContainer');\n            this.node.addChild(this.backgroundContainer);\n        }\n\n        // 平台容器\n        if (!this.platformContainer) {\n            this.platformContainer = new cc.Node('PlatformContainer');\n            this.node.addChild(this.platformContainer);\n        }\n\n        // 玩家容器\n        if (!this.playerContainer) {\n            this.playerContainer = new cc.Node('PlayerContainer');\n            this.node.addChild(this.playerContainer);\n        }\n\n        // UI容器\n        if (!this.uiContainer) {\n            this.uiContainer = new cc.Node('UIContainer');\n            this.node.addChild(this.uiContainer);\n        }\n    }\n\n    /**\n     * 建立背景系統\n     */\n    private createBackgroundSystem(): void {\n        // 建立多層背景\n        this.createSkyLayer();\n        this.createMountainLayer();\n        this.createTreeLayer();\n        this.createCloudLayer();\n        \n        // 添加視差滾動組件\n        const parallaxComponent = this.backgroundContainer.addComponent(cc.Component);\n        // 這裡需要導入 ParallaxBackground 類別\n    }\n\n    /**\n     * 建立天空層\n     */\n    private createSkyLayer(): void {\n        const skyLayer = new cc.Node('SkyLayer');\n        skyLayer.addComponent(cc.Sprite);\n        skyLayer.getComponent(cc.Sprite).spriteFrame = this.createSkySpriteFrame();\n        skyLayer.setScale(3, 2);\n        skyLayer.setPosition(0, 200);\n        this.backgroundContainer.addChild(skyLayer);\n    }\n\n    /**\n     * 建立山脈層\n     */\n    private createMountainLayer(): void {\n        const mountainLayer = new cc.Node('MountainLayer');\n        mountainLayer.addComponent(cc.Sprite);\n        mountainLayer.getComponent(cc.Sprite).spriteFrame = this.createMountainSpriteFrame();\n        mountainLayer.setPosition(0, -100);\n        mountainLayer.setScale(2, 1);\n        this.backgroundContainer.addChild(mountainLayer);\n    }\n\n    /**\n     * 建立樹木層\n     */\n    private createTreeLayer(): void {\n        const treeLayer = new cc.Node('TreeLayer');\n        this.backgroundContainer.addChild(treeLayer);\n\n        // 建立多棵樹木\n        for (let i = 0; i < 8; i++) {\n            const tree = new cc.Node(`Tree_${i}`);\n            tree.addComponent(cc.Sprite);\n            tree.getComponent(cc.Sprite).spriteFrame = this.createTreeSpriteFrame();\n            \n            const x = (i - 4) * 300;\n            const y = -200 + Math.sin(i) * 50;\n            tree.setPosition(x, y);\n            tree.setScale(0.8 + Math.random() * 0.4);\n            \n            treeLayer.addChild(tree);\n        }\n    }\n\n    /**\n     * 建立雲層\n     */\n    private createCloudLayer(): void {\n        const cloudLayer = new cc.Node('CloudLayer');\n        this.backgroundContainer.addChild(cloudLayer);\n\n        // 建立多朵雲\n        for (let i = 0; i < 6; i++) {\n            const cloud = new cc.Node(`Cloud_${i}`);\n            cloud.addComponent(cc.Sprite);\n            cloud.getComponent(cc.Sprite).spriteFrame = this.createCloudSpriteFrame();\n            \n            const x = (i - 3) * 400;\n            const y = 100 + Math.random() * 100;\n            cloud.setPosition(x, y);\n            cloud.setScale(0.5 + Math.random() * 0.5);\n            \n            cloudLayer.addChild(cloud);\n        }\n    }\n\n    /**\n     * 建立平台系統\n     */\n    private createPlatformSystem(): void {\n        // 添加平台生成器組件\n        const platformGenerator = this.platformContainer.addComponent(cc.Component);\n        // 這裡需要導入 PlatformGenerator 類別\n        \n        // 建立初始地面\n        this.createInitialGround();\n    }\n\n    /**\n     * 建立初始地面\n     */\n    private createInitialGround(): void {\n        const ground = new cc.Node('Ground');\n        ground.addComponent(cc.Sprite);\n        ground.getComponent(cc.Sprite).spriteFrame = this.createGroundSpriteFrame();\n        ground.setPosition(0, -350);\n        ground.setScale(this.sceneWidth / 100, 2);\n        \n        // 添加物理碰撞\n        const collider = ground.addComponent(cc.BoxCollider);\n        collider.size = cc.size(this.sceneWidth, 200);\n        \n        const rigidBody = ground.addComponent(cc.RigidBody2D);\n        rigidBody.type = cc.RigidBody2D.Type.Static;\n        \n        this.platformContainer.addChild(ground);\n    }\n\n    /**\n     * 建立玩家\n     */\n    private createPlayer(): void {\n        const player = new cc.Node('Player');\n        player.addComponent(cc.Sprite);\n        player.getComponent(cc.Sprite).spriteFrame = this.createPlayerSpriteFrame();\n        player.setPosition(0, 0);\n        \n        // 添加物理組件\n        const rigidBody = player.addComponent(cc.RigidBody2D);\n        rigidBody.type = cc.RigidBody2D.Type.Dynamic;\n        rigidBody.gravityScale = 1;\n        \n        const collider = player.addComponent(cc.BoxCollider);\n        collider.size = cc.size(50, 80);\n        \n        // 添加玩家控制器\n        const playerController = player.addComponent(cc.Component);\n        // 這裡需要導入 PlayerController 類別\n        \n        this.playerContainer.addChild(player);\n    }\n\n    /**\n     * 設定相機\n     */\n    private setupCamera(): void {\n        const camera = cc.Camera.main;\n        if (camera) {\n            // 設定相機為 2D 模式\n            camera.projection = cc.Camera.ProjectionType.ORTHO;\n            camera.orthoHeight = 600;\n            \n            // 添加相機跟隨組件\n            const cameraFollow = camera.node.addComponent(cc.Component);\n            // 這裡需要導入 CameraFollow 類別\n        }\n    }\n\n    /**\n     * 設定場景\n     */\n    private setupScene(): void {\n        console.log('楓之谷場景設定完成');\n    }\n\n    // 精靈框架建立方法\n    private createSkySpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 200;\n        canvas.height = 200;\n        const ctx = canvas.getContext('2d');\n        \n        const gradient = ctx.createLinearGradient(0, 0, 0, 200);\n        gradient.addColorStop(0, '#87CEEB');\n        gradient.addColorStop(0.7, '#E0F6FF');\n        gradient.addColorStop(1, '#F0F8FF');\n        \n        ctx.fillStyle = gradient;\n        ctx.fillRect(0, 0, 200, 200);\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    private createMountainSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 400;\n        canvas.height = 200;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製山脈\n        ctx.fillStyle = '#8B7355';\n        ctx.beginPath();\n        ctx.moveTo(0, 200);\n        ctx.lineTo(50, 150);\n        ctx.lineTo(100, 120);\n        ctx.lineTo(150, 100);\n        ctx.lineTo(200, 80);\n        ctx.lineTo(250, 90);\n        ctx.lineTo(300, 70);\n        ctx.lineTo(350, 85);\n        ctx.lineTo(400, 100);\n        ctx.lineTo(400, 200);\n        ctx.closePath();\n        ctx.fill();\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    private createTreeSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 100;\n        canvas.height = 200;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製樹幹\n        ctx.fillStyle = '#8B4513';\n        ctx.fillRect(45, 100, 10, 100);\n        \n        // 繪製樹葉\n        ctx.fillStyle = '#228B22';\n        ctx.beginPath();\n        ctx.arc(50, 100, 40, 0, Math.PI * 2);\n        ctx.fill();\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    private createCloudSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 120;\n        canvas.height = 60;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製雲朵\n        ctx.fillStyle = '#FFFFFF';\n        ctx.beginPath();\n        ctx.arc(30, 30, 20, 0, Math.PI * 2);\n        ctx.arc(50, 30, 25, 0, Math.PI * 2);\n        ctx.arc(70, 30, 20, 0, Math.PI * 2);\n        ctx.arc(50, 20, 15, 0, Math.PI * 2);\n        ctx.fill();\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    private createGroundSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 100;\n        canvas.height = 100;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製草地\n        ctx.fillStyle = '#90EE90';\n        ctx.fillRect(0, 0, 100, 100);\n        \n        // 添加草地紋理\n        ctx.fillStyle = '#7CCD7C';\n        for (let i = 0; i < 20; i++) {\n            const x = Math.random() * 100;\n            const y = Math.random() * 100;\n            ctx.fillRect(x, y, 2, 2);\n        }\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    private createPlayerSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 50;\n        canvas.height = 80;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製簡單的玩家角色\n        // 頭部\n        ctx.fillStyle = '#FFDBAC';\n        ctx.beginPath();\n        ctx.arc(25, 60, 15, 0, Math.PI * 2);\n        ctx.fill();\n        \n        // 身體\n        ctx.fillStyle = '#FF6B6B';\n        ctx.fillRect(20, 30, 10, 30);\n        \n        // 腿部\n        ctx.fillStyle = '#4ECDC4';\n        ctx.fillRect(18, 10, 6, 20);\n        ctx.fillRect(26, 10, 6, 20);\n        \n        // 手臂\n        ctx.fillStyle = '#FFDBAC';\n        ctx.fillRect(15, 35, 5, 15);\n        ctx.fillRect(30, 35, 5, 15);\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n}\n"]}