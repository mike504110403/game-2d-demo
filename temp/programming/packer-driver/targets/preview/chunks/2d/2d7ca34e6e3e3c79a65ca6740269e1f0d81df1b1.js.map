{"version":3,"sources":["file:///Users/mike/Documents/self/game-2d-demo/assets/scripts/components/TeleportPortal.ts"],"names":["ccclass","property","cc","_decorator","TeleportPortal","Node","Vec2","Component","isTeleporting","playerInRange","teleportTimer","onLoad","initializePortal","start","setupPortal","update","deltaTime","updateTeleportTimer","collider","node","getComponent","BoxCollider","newCollider","addComponent","size","isTrigger","rigidBody","RigidBody2D","newRigidBody","type","Type","Static","console","log","portalName","createPortalEffect","createPortalLabel","sprite","Sprite","spriteFrame","createPortalSpriteFrame","startPortalAnimation","labelNode","Label","string","fontSize","setPosition","addChild","rotateAction","rotateBy","repeatAction","repeatForever","runAction","scaleUp","scaleTo","scaleDown","scaleSequence","sequence","scaleRepeat","teleportDelay","executeTeleport","teleportEffect","playTeleportEffect","director","loadScene","targetScene","effectNode","position","createParticleEffect","createFlashEffect","parent","setTimeout","destroy","flashNode","createFlashSpriteFrame","setScale","fadeOut","remove","removeSelf","onTriggerEnter","other","self","name","showTeleportPrompt","onTriggerExit","hideTeleportPrompt","checkTeleportConditions","requiredLevel","requiredItem","startTeleport","texture","Texture2D","canvas","document","createElement","width","height","ctx","getContext","gradient","createRadialGradient","addColorStop","fillStyle","beginPath","arc","Math","PI","fill","strokeStyle","lineWidth","stroke","initWithElement","SpriteFrame","setTexture","setTarget","sceneName","targetPosition","setPortalName","v2"],"mappings":"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","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n/**\n * 傳送門組件\n * 實現楓之谷風格的傳送點功能\n */\n@ccclass('TeleportPortal')\nexport class TeleportPortal extends cc.Component {\n    @property(cc.Node)\n    targetScene: string = '';\n\n    @property(cc.Vec2)\n    targetPosition: cc.Vec2 = cc.v2(0, 0);\n\n    @property\n    teleportDelay: number = 1.0;\n\n    @property\n    teleportEffect: boolean = true;\n\n    @property\n    portalName: string = '傳送點';\n\n    @property\n    requiredLevel: number = 1;\n\n    @property\n    requiredItem: string = '';\n\n    private isTeleporting: boolean = false;\n    private playerInRange: boolean = false;\n    private teleportTimer: number = 0;\n\n    onLoad() {\n        this.initializePortal();\n    }\n\n    start() {\n        this.setupPortal();\n    }\n\n    update(deltaTime: number) {\n        if (this.isTeleporting) {\n            this.updateTeleportTimer(deltaTime);\n        }\n    }\n\n    /**\n     * 初始化傳送門\n     */\n    private initializePortal(): void {\n        // 添加碰撞檢測\n        const collider = this.node.getComponent(cc.BoxCollider);\n        if (!collider) {\n            const newCollider = this.node.addComponent(cc.BoxCollider);\n            newCollider.size = cc.size(100, 150);\n            newCollider.isTrigger = true;\n        }\n\n        // 添加剛體\n        const rigidBody = this.node.getComponent(cc.RigidBody2D);\n        if (!rigidBody) {\n            const newRigidBody = this.node.addComponent(cc.RigidBody2D);\n            newRigidBody.type = cc.RigidBody2D.Type.Static;\n        }\n\n        console.log(`傳送門 \"${this.portalName}\" 初始化完成`);\n    }\n\n    /**\n     * 設定傳送門\n     */\n    private setupPortal(): void {\n        // 建立傳送門視覺效果\n        this.createPortalEffect();\n        \n        // 添加提示文字\n        this.createPortalLabel();\n    }\n\n    /**\n     * 建立傳送門特效\n     */\n    private createPortalEffect(): void {\n        // 建立傳送門精靈\n        const sprite = this.node.addComponent(cc.Sprite);\n        sprite.spriteFrame = this.createPortalSpriteFrame();\n        \n        // 設定動畫效果\n        this.startPortalAnimation();\n    }\n\n    /**\n     * 建立傳送門標籤\n     */\n    private createPortalLabel(): void {\n        const labelNode = new cc.Node('PortalLabel');\n        labelNode.addComponent(cc.Label);\n        labelNode.getComponent(cc.Label).string = this.portalName;\n        labelNode.getComponent(cc.Label).fontSize = 20;\n        labelNode.setPosition(0, 80);\n        this.node.addChild(labelNode);\n    }\n\n    /**\n     * 開始傳送門動畫\n     */\n    private startPortalAnimation(): void {\n        // 旋轉動畫\n        const rotateAction = cc.rotateBy(2.0, 360);\n        const repeatAction = cc.repeatForever(rotateAction);\n        this.node.runAction(repeatAction);\n\n        // 縮放動畫\n        const scaleUp = cc.scaleTo(1.0, 1.2);\n        const scaleDown = cc.scaleTo(1.0, 0.8);\n        const scaleSequence = cc.sequence(scaleUp, scaleDown);\n        const scaleRepeat = cc.repeatForever(scaleSequence);\n        this.node.runAction(scaleRepeat);\n    }\n\n    /**\n     * 更新傳送計時器\n     */\n    private updateTeleportTimer(deltaTime: number): void {\n        this.teleportTimer += deltaTime;\n        \n        if (this.teleportTimer >= this.teleportDelay) {\n            this.executeTeleport();\n        }\n    }\n\n    /**\n     * 執行傳送\n     */\n    private executeTeleport(): void {\n        if (this.teleportEffect) {\n            this.playTeleportEffect();\n        }\n\n        // 載入目標場景\n        cc.director.loadScene(this.targetScene, () => {\n            console.log(`成功傳送到場景: ${this.targetScene}`);\n            this.isTeleporting = false;\n            this.teleportTimer = 0;\n        });\n    }\n\n    /**\n     * 播放傳送特效\n     */\n    private playTeleportEffect(): void {\n        // 建立傳送特效\n        const effectNode = new cc.Node('TeleportEffect');\n        effectNode.setPosition(this.node.position);\n        \n        // 添加粒子效果\n        this.createParticleEffect(effectNode);\n        \n        // 添加閃光效果\n        this.createFlashEffect(effectNode);\n        \n        this.node.parent.addChild(effectNode);\n        \n        // 3秒後移除特效\n        setTimeout(() => {\n            effectNode.destroy();\n        }, 3000);\n    }\n\n    /**\n     * 建立粒子特效\n     */\n    private createParticleEffect(parent: cc.Node): void {\n        // 這裡可以添加粒子系統\n        console.log('傳送粒子特效播放');\n    }\n\n    /**\n     * 建立閃光特效\n     */\n    private createFlashEffect(parent: cc.Node): void {\n        const flashNode = new cc.Node('Flash');\n        flashNode.addComponent(cc.Sprite);\n        flashNode.getComponent(cc.Sprite).spriteFrame = this.createFlashSpriteFrame();\n        flashNode.setScale(2, 2);\n        \n        const fadeOut = cc.fadeOut(0.5);\n        const remove = cc.removeSelf();\n        const sequence = cc.sequence(fadeOut, remove);\n        \n        parent.addChild(flashNode);\n        flashNode.runAction(sequence);\n    }\n\n    /**\n     * 碰撞檢測\n     */\n    onTriggerEnter(other: cc.Collider, self: cc.Collider): void {\n        if (other.node.name === 'Player') {\n            this.playerInRange = true;\n            this.showTeleportPrompt();\n        }\n    }\n\n    onTriggerExit(other: cc.Collider, self: cc.Collider): void {\n        if (other.node.name === 'Player') {\n            this.playerInRange = false;\n            this.hideTeleportPrompt();\n        }\n    }\n\n    /**\n     * 顯示傳送提示\n     */\n    private showTeleportPrompt(): void {\n        console.log(`按 E 鍵傳送到 ${this.portalName}`);\n        // 這裡可以顯示UI提示\n    }\n\n    /**\n     * 隱藏傳送提示\n     */\n    private hideTeleportPrompt(): void {\n        console.log('離開傳送門範圍');\n        // 隱藏UI提示\n    }\n\n    /**\n     * 檢查傳送條件\n     */\n    private checkTeleportConditions(): boolean {\n        // 檢查等級要求\n        if (this.requiredLevel > 1) {\n            // 這裡可以檢查玩家等級\n            console.log(`需要等級 ${this.requiredLevel}`);\n        }\n\n        // 檢查道具要求\n        if (this.requiredItem) {\n            // 這裡可以檢查玩家是否擁有特定道具\n            console.log(`需要道具: ${this.requiredItem}`);\n        }\n\n        return true; // 暫時總是返回true\n    }\n\n    /**\n     * 開始傳送\n     */\n    public startTeleport(): void {\n        if (this.isTeleporting || !this.playerInRange) {\n            return;\n        }\n\n        if (!this.checkTeleportConditions()) {\n            return;\n        }\n\n        this.isTeleporting = true;\n        this.teleportTimer = 0;\n        console.log(`開始傳送到 ${this.targetScene}`);\n    }\n\n    /**\n     * 建立傳送門精靈框架\n     */\n    private createPortalSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 100;\n        canvas.height = 150;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製傳送門\n        const gradient = ctx.createRadialGradient(50, 75, 0, 50, 75, 50);\n        gradient.addColorStop(0, '#00FFFF');\n        gradient.addColorStop(0.5, '#0080FF');\n        gradient.addColorStop(1, '#0040FF');\n        \n        ctx.fillStyle = gradient;\n        ctx.beginPath();\n        ctx.arc(50, 75, 40, 0, Math.PI * 2);\n        ctx.fill();\n        \n        // 添加邊框\n        ctx.strokeStyle = '#FFFFFF';\n        ctx.lineWidth = 3;\n        ctx.stroke();\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    /**\n     * 建立閃光精靈框架\n     */\n    private createFlashSpriteFrame(): cc.SpriteFrame {\n        const texture = new cc.Texture2D();\n        const canvas = document.createElement('canvas');\n        canvas.width = 200;\n        canvas.height = 200;\n        const ctx = canvas.getContext('2d');\n        \n        // 繪製閃光\n        const gradient = ctx.createRadialGradient(100, 100, 0, 100, 100, 100);\n        gradient.addColorStop(0, '#FFFFFF');\n        gradient.addColorStop(0.3, '#FFFF00');\n        gradient.addColorStop(1, '#FF8000');\n        \n        ctx.fillStyle = gradient;\n        ctx.beginPath();\n        ctx.arc(100, 100, 100, 0, Math.PI * 2);\n        ctx.fill();\n        \n        texture.initWithElement(canvas);\n        const spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture);\n        return spriteFrame;\n    }\n\n    /**\n     * 設定傳送目標\n     */\n    public setTarget(sceneName: string, position: cc.Vec2): void {\n        this.targetScene = sceneName;\n        this.targetPosition = position;\n    }\n\n    /**\n     * 設定傳送門名稱\n     */\n    public setPortalName(name: string): void {\n        this.portalName = name;\n    }\n}\n"]}